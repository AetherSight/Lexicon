"""
FFXIV装备标签体系定义
定义了装备图片需要标注的各种属性标签
"""

# 颜色标签
COLOR_LABELS = [
    "金色", "银色", "黑色", "白色", "红色", "蓝色", "绿色", 
    "紫色", "黄色", "橙色", "粉色", "棕色", "灰色", "透明",
    "彩虹色", "渐变色",
    # 扩展色系（从CSV中提取）
    "暗灰色", "暗红色", "暗绿色",
    "浅灰色",
    "深棕色", "深灰色", "深紫色", "深红色", "深绿色", "深蓝色",
    "米色", "青色"
]

# 材质标签
MATERIAL_LABELS = [
    "金属", "布料", "皮革", "透明材质", "发光材质", "哑光", 
    "光泽", "丝绸", "毛皮", "水晶", "宝石", "木质",
    "骨质", "玻璃", "纤维",
    "合金", "龙鳞", "羽毛材质", "鳞片",
    "甲壳", "硬质", "软质", 
    "光滑", "编织", "针织",
    "皮革质感", "金属质感", "布料质感",
    # 从CSV数据中提取的新材质标签
    "丝绸质感", "半透明", "半透明材质", "毛皮材质", "毛皮质感",
    "皮革材质", "磨损", "蕾丝", "金属材质", 
]

# 形状特征标签
SHAPE_LABELS = [
    "细", "粗", "扁", "圆", "方", "尖", "长", "短", "宽", 
    "窄", "厚", "薄", "弯曲", "直线", "对称", "不对称",
    "椭圆形", "三角形", "菱形", "六角形",
    "圆柱形", "圆锥形", "球形", "扁平", "立体",
    "流线型", "棱角分明", "圆润", "尖锐", "锐角",
    "曲线", "波浪形", "螺旋形", "锯齿形", "不规则",
    "规整", "紧凑", "松散", "均匀",
    "层次感", "立体感", "凹凸", "起伏", "平滑",
    "宽肩", "外扩肩部轮廓",
    # 从CSV数据中提取的新形状标签
    "A字下摆", "A字型", "A字形", "A字形下摆", "A字裙", "A字裙摆",
    "V型", "V型肩部", "V型背带", "V型领口", "V字形", "V形", "V领",
    "X形",
    "不规则下摆", "中长款", "交叉", "交叉V形", "交叉结构", "交叉装饰", "交叉设计",
    "修身", "修长", "几何图案", "几何形状", "分叉", "分叉下摆",
    "分层", "分层下摆", "分层结构", "分层设计", "分段下摆", "分段式",
    "分片下摆", "前后开衩", "合体", "合身",
    "喇叭形", "喇叭形袖口", "喇叭状", "喇叭袖",
    "圆弧形", "圆形", "圆球状", "圆肩", "圆角", "圆领",
    "垂坠", "垂坠感", "垂布", "垂布下摆", "垂直", "垂直排列",
    "多层次", "宽大", "宽松", "宽肩部轮廓", "宽腰带", "宽袖",
    "尖刺", "尖形", "尖角", "尖锐下摆", "尖锐线条",
    "层叠", "层叠下摆", "平直", "平直下摆", "开衩", "开衩下摆",
    "弧形", "弧形下摆", "悬垂", "护肩", "挺括",
    "撕裂", "撕裂边", "收腰", "敞开式",
    "斜挎", "斜线", "斜肩", "斜肩设计", "斜裁", "斜跨", "斜跨背带",
    "方形", "无袖", "星形", "有层次感", "束腰",
    "条纹", "毛皮镶边", "毛边", "波浪边", "流畅", "流畅线条",
    "流苏", "流苏下摆", "流苏状", "灯笼袖", "百褶",
    "直", "直筒", "直线型", "直线条", "矩形",
    "短款", "短袖", "短裙", "短裤", "破洞", "硬质",
    "窄肩", "窄袖口", "立领", "竖向分割", "竖直线条", "系带",
    "紧致", "紧身", "纵向装饰", "细长",
    "结构化下摆", "网状", "网眼", "羽毛状", "翅膀",
    "翻领", "肩部外扩", "背带式", "背部结构化",
    "腰封", "腰部束带", "荷叶边", "菱形结构",
    "蓬松", "蓬松袖", "裙摆", "裙装下摆", "褶皱", "贴身",
    "金属装饰", "铆钉装饰", "锥形下摆", "锯齿形装饰", "锯齿边", "镂空",
    "长形", "长方形", "长条形", "长条状", "长款", "长筒",
    "长袍", "长袍式下摆", "长袖", "长裙", "长裤", "长靴",
    "露肩", "露背", "露腰", "露腹", "高开衩", "高领", "鳞片", "鼓起"
]

# 装饰元素标签（已合并近义、去除明显冗余变体）
DECORATION_LABELS = [
    # 基础装饰形态
    "蝴蝶结", "花纹", "图案", "符号",
    "条纹", "斑点", "网格", "格子", "几何图案",
    "花朵", "花边", "荷叶边", "波浪边", "锯齿边", "圆边",
    "镂空", "穿孔", "拼贴", "拼接", "纹理",

    # 花卉 / 植物
    "百合", "彼岸花", "玫瑰", "蔷薇", "樱花", "莲花", "菊花", "牡丹",
    "花卉图案", "花朵图案", "花朵装饰", "花束",
    "叶子", "叶子图案", "藤蔓", "藤蔓纹", "藤蔓装饰",

    # 纹样 / 纹章 / 抽象纹理
    "云纹", "水波纹", "火焰纹", "雷电纹",
    "暗纹", "纹样", "纹路", "纹身", "纹身图案", "纹饰",
    "几何纹样", "几何纹路", "几何纹饰", "几何线条", "几何装饰",
    "巴洛克花纹", "雕刻", "雕刻图案", "雕刻花纹", "雕刻装饰", "雕花",

    # 星象 / 符文 / 图腾
    "星形", "五角星", "六芒星", "星座图案", "星形图案", "星形装饰", "星星", "星星图案",
    "月牙", "太阳",
    "图腾符号", "符文", "箭头符号",

    # 金属与宝石
    "宝石", "宝石装饰", "宝石点缀", "宝石镶嵌",
    "珍珠", "珍珠装饰", "珠子", "珠子装饰",
    "水晶", "钻石", "玉石", "玛瑙", "琥珀",
    "金属装饰", "金属边框", "金属链", "金属丝", "金属条",
    "金属铆钉", "金属镶嵌", "金属镶边", "金属雕刻",
    "金属护甲", "金属腰带", "金属肩带",
    "金属拉链", "金属挂件", "金属垂饰",
    "金色刺绣", "金色图案", "金色条纹", "金色花纹", "金色装饰",

    # 机械 / 时钟
    "齿轮", "齿轮图案", "齿轮装饰",
    "表盘", "机械挂件",

    # 布料 & 带类装饰
    "丝带", "飘带", "装饰带", "装饰条", "横向装饰条",
    "装饰边", "装饰线条", "线条", "线条装饰",
    "流苏", "流苏装饰", "穗子", "毛球", "绒球",
    "围巾", "围巾式装饰", "披风",
    "带子", "条带", "绑带", "腰带", "腰带装饰",

    # 扣具 / 连接件
    "铆钉", "铆钉装饰",
    "扣子", "纽扣", "纽扣装饰",
    "皮带扣", "腰带扣", "腰带扣饰",
    "搭扣", "卡扣", "按扣", "暗扣", "明扣",
    "环扣", "金属环", "金属环扣", "圆环",
    "D型环", "O型环",

    # 口袋 / 包类
    "口袋", "方形口袋",
    "皮袋", "工具包", "工具腰带",

    # 生物 / 生物部位
    "龙纹", "龙纹图案", "龙纹装饰", "龙纹雕刻",
    "龙鳞", "龙鳞装饰",
    "龙", "凤凰纹", "凤凰",
    "独角兽", "独角兽图案",
    "骷髅", "骷髅装饰", "骨骼装饰",
    "蝙蝠", "蝙蝠图案", "蝙蝠纹",
    "蝴蝶", "蝴蝶图案", "蝴蝶纹",
    "翅膀", "羽毛", "羽毛图案", "羽毛装饰", "羽翼",
    "鸟",

    # 节日 / 特殊主题
    "南瓜装饰", "南瓜灯装饰",

    # 神话 / 圣物相关
    "十字", "十字架", "圣十字", "倒十字",

    # 破损 / 老化效果
    "破洞", "破损", "撕裂", "撕裂图案", "撕裂边缘",
    "肮脏", "污渍", "陈旧", "褪色", "老化",
    "破布装饰", "破损下摆", "磨损", "磨损痕迹",

    # 其它抽象/组合装饰
    "挂件", "挂坠", "吊坠", "挂饰",
    "沙漏", "钥匙", "钥匙装饰",
    "浆果", "灯笼", "灯笼挂件",
    "爪状装饰", "爪部装饰",
    "环状", "球形装饰",

    # 领口 / 袖口 / 局部装饰
    "领口装饰", "领口褶皱",
    "袖饰", "袖口", "袖口装饰", "袖口镶边",

    # 肩 / 腰 / 局部护甲
    "护肩", "肩饰", "肩甲", "肩甲装饰", "肩部装饰",
    "腰饰", "腰带束带",

    # 其它已使用的典型装饰
    "中国结", "图腾符号", "凯尔特纹饰",
    "徽章", "徽章装饰",
    "装饰链", "链条", "链条装饰",
    "镶边", "镶嵌",
]

# 风格标签
STYLE_LABELS = [
    "古典", "现代", "华丽", "简约", "暗黑", "光明", "优雅",
    "粗犷", "精致", "复古", "未来感", "奇幻", "军事风", 
    "休闲", "正式", "哥特式", "巴洛克", "洛可可", "维多利亚",
    "蒸汽朋克", "赛博朋克", "废土风", "末日风", "魔法风",
    "科技风", "机械风", "工业风", "自然风", "田园风", "都市风",
    "东方风格", "西方风格", "日式", "中式", "欧式", "美式",
    "民族风", "部落风", "原始风", "文明风", "野蛮风",
    "贵族风", "平民风", "骑士风", "法师风", "盗贼风", "战士风",
    "乞丐风", "流浪风", "贫民风", "破旧风", "邋遢风",
    "圣职风", "暗黑风", "光明风", "神圣风", "邪恶风", "中性风",
    "天使风", "恶魔风", "天堂风", "地狱风", "神话风", "传说风",
    "暗法系", "祭司风", "宗教风格", "贵族暗黑",
    "男性化", "女性化", "中性化", "硬朗", "柔美", "刚柔并济",
    "庄重", "活泼", "严肃", "轻松", "随意", "隆重",
    "日常", "战斗", "仪式", "庆典", "节日",
    "学院风",
    # 从CSV数据中提取的新风格标签
    "严谨", "中世纪风", "中国风", "传统", "传统风", "冒险风", "军旅风", "军装风",
    "工匠风", "工装风", "庄严", "探险风", "神秘", "经典", "武士风", "海盗风",
    "航海风", "街头风", "轻盈", "金属风", "铠甲风", "铠甲风格", "铠袍风格", "魔幻风",
    # 场景风格
    "婚礼", "游乐场", "赌场", "派对", "舞会", "宴会", "音乐会", "剧院", "电影院",
    "咖啡厅", "餐厅", "酒吧", "夜店", "KTV", "健身房", "游泳池", "海滩", "公园",
    "森林", "沙漠", "雪山", "城市", "乡村", "学校", "医院", "办公室", "工厂",
    "实验室", "图书馆", "博物馆", "教堂", "寺庙", "城堡", "宫殿", "地牢", "洞穴",
    "战场", "竞技场", "角斗场", "训练场", "演武场", "魔法塔", "炼金室", "工坊",
    "市场", "商店", "旅馆", "酒馆", "驿站", "港口", "码头", "船", "飞空艇",
    "室内", "室外", "白天", "夜晚", "黄昏", "黎明",
    # 暴露程度相关
    "暴露", "高暴露", "低暴露", "保守", "封闭", "性感", "大胆",
    "露肩", "露背", "露腿", "露腰", "露胸", "露腹",
    "紧身", "宽松", "贴身", "修身", "裸体",
]

# 特殊效果标签
EFFECT_LABELS = [
    "发光", "阴影", "反射",
    "半透明", "渐变", "纹理"
]

# 外观类型列表（AI只能从这个列表中选择"长得像XX"）
# 注意：这些是外形描述，不是功能分类，用于描述装备看起来像什么
APPEARANCE_TYPES = [
    # 头部装备外形
    "头盔", "帽子", "头饰", "面具", "眼罩",
    # 身体装备外形
    "衣服", "上衣", "短衣", "衬衫", "长袍", "短袍", "法袍", "礼仪长袍", "铠袍", "铠甲", "胸甲", "背心",
    "燕尾服", "婚纱", "礼服", "和服", "浴衣", "旗袍", "西装", "夹克", "风衣", "斗篷", "披风",
    "马甲", "T恤", "卫衣", "运动服", "泳装", "比基尼", "内衣", "睡衣", "工作服", "制服",
    "校服", "军装", "警服", "医生服", "护士服", "厨师服", "服务生服", "小丑服", "魔术师服",
    "舞者服", "歌手服", "演员服", "模特服", "宇航服", "潜水服", "滑雪服", "登山服", "雨衣",
    "防弹衣", "防化服", "消防服", "囚服", "僧袍", "道袍", "祭司法袍", "主教袍",
    # 手部装备外形
    "手套", "护手", "手甲", "手环",
    # 腿部装备外形
    "裤子", "长裤", "短裤", "喇叭裤", "阔腿裤", "紧身裤", "九分裤", "七分裤", "马裤",
    "裙子", "短裙", "长裙", "中裙", "超短裙", "百褶裙", "蓬蓬裙",
    # 脚部装备外形
    "靴子", "鞋子", "长靴", "短靴", "凉鞋",
    # 饰品外形
    "项链", "手镯", "戒指",
    # 武器外形
    "双手剑", "单手剑", "刺剑", "武士刀", "双剑", "对剑",
    "火枪", "枪刃", "盾牌", "幻杖", "咒杖", "弓箭", "魔导书",
    "其他"  # 如果都不像，可以选择"其他"
]

# 支持的装备类型列表（仅用于验证输入，不用于AI识别）
ALLOWED_EQUIPMENT_TYPES = [
    "头部",
    "衣服",
    "手部",
    "腿部",
    "脚部",
    "项链",
    "手镯",
    "戒指",
    "双手剑",
    "单手剑",
    "刺剑",
    "武士刀",
    "双剑",
    "对剑",
    "火枪",
    "枪刃",
    "盾牌",
    "幻杖",
    "咒杖",
    "弓箭",
    "魔导书",
]

def get_allowed_equipment_types():
    """获取所有允许的装备类型列表"""
    return ALLOWED_EQUIPMENT_TYPES.copy()


def get_all_labels():
    """获取所有标签列表"""
    all_labels = []
    all_labels.extend(COLOR_LABELS)
    all_labels.extend(MATERIAL_LABELS)
    all_labels.extend(SHAPE_LABELS)
    all_labels.extend(DECORATION_LABELS)
    all_labels.extend(STYLE_LABELS)
    all_labels.extend(EFFECT_LABELS)
    return all_labels

def get_prompt_template() -> str:
    """
    生成标注提示词模板
    """
    
    prompt = """你是一个专业的FFXIV装备图片标注专家。请仔细分析这张装备图片，描述装备的外形特征和视觉属性。

**重要说明：**
- 你不需要识别装备的具体类型或名称
- 你只需要描述装备的外形、细节、颜色、风格等视觉特征
- 如果装备看起来像某种武器或装备，必须从以下列表中选择"长得像XX"：
  {appearance_types}
- 专注于视觉特征的描述，而不是功能识别

请从以下标签类别中选择所有适用的标签：

1. **颜色**：{colors}
2. **材质**：{materials}
3. **形状特征**：{shapes}
4. **装饰元素**：{decorations}
5. **风格**：{styles}
6. **特殊效果**：{effects}
7. **外观类型**：{appearance_types}（可以选择多个，例如：["双手剑", "盾牌"]）
8. **自定义标签**：必须提供至少5个、最多10个自定义标签。这些标签是你经过思考后认为应该添加但上面1-7类中没有的标签，用于描述装备的独特特征。每个标签不得超过8个汉字。

**重要：输出格式必须严格按照以下JSON格式，不要添加任何其他文字：**

{{
    "colors": ["标签1", "标签2"],
    "materials": ["标签1"],
    "shapes": ["标签1", "标签2"],
    "decorations": ["标签1"],
    "styles": ["标签1"],
    "effects": ["标签1"],
    "appearance_looks_like": ["双手剑", "盾牌"],
    "appearance_description": "详细描述装备的外形特征和主要特点",
    "custom_tags": ["自定义标签1", "自定义标签2"]
}}

注意：
- 如果某个类别没有适用的标签，使用空数组 []
- 标签名称必须完全匹配上面提供的标签列表
- appearance_looks_like 字段是一个数组，可以从列表中选择多个值（例如：["双手剑", "盾牌"]），如果都不像可以选择 ["其他"]
- appearance_description 字段必须填写，详细描述装备的外形特征（例如："剑身宽大，有装饰纹路，整体呈流线型"）
- custom_tags 字段：**必须填写**，提供至少1个、最多5个自定义标签。这些标签是你经过思考后认为应该添加但上面1-7类中没有的标签，用于描述装备的独特特征。**每个标签不得超过8个汉字**。这些标签应该反映你对装备的深入观察和思考，而不是随意添加。如果实在无法找到合适的自定义标签，至少提供1个经过思考的描述性标签。
- 只输出纯JSON，不要添加任何解释、说明或markdown代码块"""
    
    return prompt.format(
        colors=', '.join(COLOR_LABELS),
        materials=', '.join(MATERIAL_LABELS),
        shapes=', '.join(SHAPE_LABELS),
        decorations=', '.join(DECORATION_LABELS),
        styles=', '.join(STYLE_LABELS),
        effects=', '.join(EFFECT_LABELS),
        appearance_types=', '.join(APPEARANCE_TYPES),
        appearance_types_list=', '.join(APPEARANCE_TYPES)
    )

